


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Notifications &#8212; dbuild Documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
    <link rel="stylesheet" href="_static/base.css" type="text/css" />
    <link rel="stylesheet" href="_static/docs.css" type="text/css" />
    <link rel="stylesheet" href="_static/syntax.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Exo:300,400,600,700" type="text/css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="../versions.js"></script>
    <script src="_static/set-versions.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Comparing artifacts" href="comparison.html" />
    <link rel="prev" title="Deploying" href="deploy.html" /> 
  </head><body>
  <div class="navbar">
    <div class="navbar-inner">
      <div class="container">
        <ul class="nav">
          <li><a href="index.html">Home</a></li>
          <li><a href="download.html">Download</a></li>
          <li><a href="https://github.com/lightbend-labs/dbuild">GitHub Project</a></li>
        </ul>
      </div>
    </div>
  </div>
  <div class="main">
    <div class="container">
      <div class="page-title">Notifications</div>
    </div>
    <div class="main-container">
      <div class="container">
        <div class="row">
          <div class="span12">
            <ul class="breadcrumb">        
              <li>
                 <span class="divider">|</span> <a href="comparison.html">Comparing artifacts</a> <span class="divider">»</span>
              </li>
              <li>
              </li>
              <li>
                <a href="index.html">Contents</a>
              </li>
              <li>
                <span class="divider">«</span> <a href="deploy.html">Deploying</a> <span class="divider">|</span>
              </li>
              <li>
                <select id="versions"><option selected value="0.9.20">Version 0.9.20</option></select>
              </li>
            </ul>         
          </div>
        </div>
        <div class="row">
          <div class="span9">
            
  <section id="notifications">
<h1>Notifications<a class="headerlink" href="#notifications" title="Permalink to this heading">¶</a></h1>
<section id="the-notifications-section">
<span id="section-notifications"></span><h2>The <code class="docutils literal notranslate"><span class="pre">notifications</span></code> section<a class="headerlink" href="#the-notifications-section" title="Permalink to this heading">¶</a></h2>
<p>Another task that dbuild can automatically take care of, after the build, is notifying users
and maintainers about the outcomes of the various compilations, using of a rather
flexible notification system.</p>
<p>Notifications are controlled using the following description:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{
 build: {projects:..., options:...}

 options: {

  notifications: {
   send      : [&lt;notification1&gt;,&lt;notification2&gt;,...]
   default   : [&lt;recipient-pattern1&gt;,&lt;recipient-pattern2&gt;,...]
   templates : [&lt;optional-template1&gt;,
  }

  ...
 }
}
</pre></div>
</div>
<dl class="simple">
<dt>send</dt><dd><p>Is a list of notifications. Each notification specifies when and where to send
a message, the kind of the message, and the kind of report that should be sent.
The text of each notification is built using message templates, described below.</p>
</dd>
<dt>default</dt><dd><p>Multiple notifications may use common information; for example,
in the case of email messages, many notifications may use the same mail server,
or may all have a common “CC” recipient. The “default” list allows you to specify just once
some defaults that will be inherited by all the notifications, which
will then be able to override them individually. See below for a useful example.
The list of defaults is optional.</p>
</dd>
<dt>template</dt><dd><p>By default, the text of messages is generated using some standard templates,
depending on the kind of message. As an additional facility it is possible to
define custom templates in order to personalize the message for one or multiple
notification.
The templating facility is still preliminary and some details may change in future
versions. In normal usage, this section can just be omitted in order to use the
standard templates.</p>
</dd>
</dl>
<p>The “send” and “default” fields, in addition to a list, will also accept a single
notification; in that case, the square brackets can be omitted. That,
combined with the extended JSON syntax of the
<a class="reference external" href="https://github.com/lightbend/config">config library</a>, makes for a practical
shortened syntax. An example can be found later on this page.</p>
<p>If the list of notifications is empty, by default a short report will be printed to
the console.</p>
<p>If you are working on a build configuration file that is normally deployed elsewhere,
for instance on a remote Jenkins server, and you want to test it locally without
having notifications sent out, just append the flag <code class="docutils literal notranslate"><span class="pre">--no-notify</span></code> (or <code class="docutils literal notranslate"><span class="pre">-n</span></code>) to
your command line. Use <code class="docutils literal notranslate"><span class="pre">dbuild</span> <span class="pre">--help</span></code> to find out further details and options.</p>
</section>
<section id="id1">
<h2>Notifications<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h2>
<p>Each notification has the following structure:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="nx">kind</span><span class="w">     </span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">notification</span><span class="o">-</span><span class="nx">kind</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">when</span><span class="w">     </span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">when</span><span class="o">-</span><span class="nx">selector</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">send</span><span class="w">     </span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">message</span><span class="o">-</span><span class="nx">recipients</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w"> </span><span class="nx">projects</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="o">&lt;</span><span class="nx">project1</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="nx">project2</span><span class="o">&gt;</span><span class="p">,...]</span><span class="w"></span>
<span class="w"> </span><span class="nx">template</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">optional</span><span class="o">-</span><span class="nx">template</span><span class="o">-</span><span class="nx">selector</span><span class="o">&gt;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<dl class="simple">
<dt>kind</dt><dd><p>The “kind” of a notification refers to the mechanism that is used to deliver the
message. The notification infrastructure has been designed to be very easily
extendable with further notification systems, like tweets, posts, etc. The
notification kinds available at this time are “email”, “flowdock”, and “console”.
If “kind” is not specified, it will be assumed to be “email”.</p>
</dd>
<dt>when</dt><dd><p>There are several possible outcomes from a dbuild run. For example, it could be
that the dependency
extraction phase was unsuccessful, or the build of one or more projects failed.
Maybe deployment failed, or rather everything was ok. The “when” selector allows
you to select exactly when the notification should be sent out. It can be a
single identifier, or a list of identifiers. The list will be matched against the
outcome of a project, and the message will be sent out only if there is a match.
The list of possible outcomes is described below.</p>
</dd>
<dt>send</dt><dd><p>This is a kind-specific description of the intended recipients of the notification.
The exact details depend on the notification kind, and are listed further down
on this page.</p>
</dd>
<dt>projects</dt><dd><p>This is a list of projects to which the notification applies. Within the same
notification, a separate message will be sent for each of the listed projects.
If you use the string “.”, a message will be sent for the outcome of the entire
dbuild run. Each report will be especially
tailored for that project, with its specific dependencies, etc. However, each
report will be sent only if the outcome of that project matches the “when”
selector of the notification.</p>
</dd>
<dt>template</dt><dd><p>The optional string “template” can be used to select one of the custom or standard
templates. There are three predefined templates: “email”, “flowdock”, and “console”. If the template
is not specified, the template with the same name as the kind will be used. However,
you could in theory send an email using the console template, or print onscreen the
text of an email. If you want to use a custom template, just define it in the
“templates” section, and refer to it here by using its identifier.
You can also override the standard template for all the
email messages by defining in the templates section a template called “email”,
which will override the standard one.</p>
</dd>
</dl>
</section>
<section id="outcomes-and-when">
<h2>Outcomes and “when”<a class="headerlink" href="#outcomes-and-when" title="Permalink to this heading">¶</a></h2>
<p>A notification will be processed for a project only when the outcome of the project
matches the “when” selector. The possible outcomes are arranged in a tree, as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>always
|
+----- good +---- success
|           |
|           +---- unchanged
|           |
|           +---- empty
|
+------ bad +---- failed
            |
            +---- dep-broken
            |
            |
            +---- extraction +---- extraction-ok
            |                |
            |                +---- extraction-failed
            |
            +---- task-failed
            |
            |
            +---- unexpected
</pre></div>
</div>
<p>The result for each project, as well as for dbuild as a whole, will always be one
of these outcomes. Since outcomes are hierarchical, each of them will be selected
when the parent is selected. For example, let’s assume that the “when” clause is
<code class="docutils literal notranslate"><span class="pre">&quot;bad&quot;</span></code>. The notification will be sent if it is “bad”, or “failed”, or “dep-broken”,
or any other bad condition. If the “when” clause is <code class="docutils literal notranslate"><span class="pre">[&quot;bad&quot;,&quot;success&quot;]</span></code>, then a
message is sent upon a build’s first success, or when something bad happened.</p>
<p>The outcomes are the following:</p>
<dl class="simple">
<dt>always</dt><dd><p>Not a real possible outcome; use “always” when you want a notification to be
generated at each run, regardless of the result.</p>
</dd>
<dt>good</dt><dd><p>The “good” outcome groups all of the successful results of a dbuild or project run.</p>
</dd>
<dt>bad</dt><dd><p>Something went wrong, either when extracting dependencies, or while building,
or while running some accessory task.</p>
</dd>
<dt>success</dt><dd><p>This outcome means that the project or the whole dbuild had a successful test run.
For a project, it means that there was some change in either its own source
code, or that there was a change in one of its dependencies. Therefore, the project
had to be recompiled, and the compilation completed successfully. For dbuild as a
whole (project “.”), it means that there was a good run and nothing failed.</p>
</dd>
<dt>unchanged</dt><dd><p>It means that a project was not rebuilt, since nothing changed in its code
or in any of its dependencies: its cached artifacts were used. The main
dbuild (project “.”) is always executed, therefore its outcome cannot
be “unchanged”: if all its projects are unchanged and all the accessory tasks
completed successfully, its final outcome will be “success”.</p>
</dd>
<dt>empty</dt><dd><p>It means that a project was not rebuilt, since no subprojects were selected.
That may happen if the list of subprojects contained patterns which matched
nothing, or if the exclusion list excludes all of the subprojects that would
be built according to the requested list.
Please remember that an empty requested list (“projects”), by itself, is
interpreted as “build all subprojects”; in that case, the outcome can be
empty only if “excludes” explicitly lists all of the available subprojects.</p>
</dd>
<dt>failed</dt><dd><p>This outcome means that dbuild reached the point in which the actual project
compilation started, but some error occurred while compiling.</p>
</dd>
<dt>dep-broken</dt><dd><p>It may happen that the first stage, project dependencies extraction, completed
successfully for all projects. However, when we reached the compilation stage,
one of the projects that this project depends on failed to build. As a result,
its dependent projects cannot be built: the status “dep-broken” means that
we cannot build this project until some other project has been fixed.</p>
</dd>
<dt>extraction</dt><dd><p>It means that we were unable to proceed to the building
stage, and stopped right after dependency extraction; it is used to group
extraction-ok and extraction-failed.</p>
</dd>
<dt>extraction-ok</dt><dd><p>This outcome is generated if dependency extraction for this particular project
succeeded (but we could not proceed to further stages).</p>
</dd>
<dt>extraction-failed</dt><dd><p>It means that this project failed during the very first stage, while inspecting
the project in order to find which other projects it depends on. It could be
that the project build file is broken, or that we were unable to check out its
source code.</p>
</dd>
<dt>task-failed</dt><dd><p>This is a “combo” status, in the sense that it also encapsulates a further
outcome. This error is generated when one of the accessory tasks of dbuild
somehow failed to run. For instance, it may mean that we could not deploy
the generated artifacts to a repository, or that we could not sign them, or
somethings similar. Since it is generated after dbuild has already accumulated
a build/extraction outcome, the initial outcome is preserved inside it;
the corresponding diagnostic message will print both.</p>
</dd>
<dt>unexpected</dt><dd><p>As a very special case, “unexpected” could possibly be generated in extreme
and exceptional circumstances, for instance as a result of an internal error.
During normal
operation, all of the possible error conditions and exceptions that are
generated while building, deploying, etc, will lead instead to one of the other
outcomes. Being only a truly unexpected occurrence, the generation of this
outcome bypasses the notifications system, and cannot be captured.</p>
</dd>
</dl>
<p>If the “when” clause is omitted, the default is <code class="docutils literal notranslate"><span class="pre">[&quot;bad&quot;,&quot;success&quot;]</span></code>, meaning that
a message is sent when something is wrong, or upon the first successful recompilation
of a project, when changes occur.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Technically, the notifications stage run as a post-build task. However, it
cannot report about errors that happen during notification itself.
The outcomes that the
notifications task will observe, therefore, is the one available after building, and after
running all the other tasks; notifications come last. Should anything go
wrong during notification, a diagnostic message will just be printed onscreen,
and an error will be returned (which can be captured by Jenkins, for example).
A further, last-resort error handler may be added in the future.</p>
</div>
</section>
<section id="the-send-clause">
<h2>The “send” clause<a class="headerlink" href="#the-send-clause" title="Permalink to this heading">¶</a></h2>
<p>Each notification kind may need further information concerning exactly where to
address the resulting messages. For the predefined kind “console” at this time
there is no further information needed. For the kind “email”, the “send”
clause is the following:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{
 to     : [&lt;addr1&gt;,&lt;addr2&gt;,...]
 cc     : [&lt;addr1&gt;,&lt;addr2&gt;,...]
 bcc    : [&lt;addr1&gt;,&lt;addr2&gt;,...]
 from   : &lt;addr&gt;
 smtp   : &lt;server-parameters&gt;
}
</pre></div>
</div>
<dl class="simple">
<dt>to, cc, bcc</dt><dd><p>They can be either a single string, or a list of strings, each specifying an email
address in the usual format. They can be in the format <code class="docutils literal notranslate"><span class="pre">user&#64;host</span></code>, or in the format
<code class="docutils literal notranslate"><span class="pre">Name</span> <span class="pre">&lt;user&#64;host&gt;</span></code>, according to the RFC 822 specification.</p>
</dd>
<dt>from</dt><dd><p>The sender that will appear in the messages. If not specified, dbuild will assemble
an email address using the current user name and the host name of the current machine.</p>
</dd>
<dt>smtp</dt><dd><p>A specification of the email server to which the messages will be sent to (see below).
If missing, dbuild will try to contact the smtp server running on localhost, port 25,
no encryption. The smtp record is:</p>
</dd>
</dl>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{
 server            : &lt;host&gt;
 encryption        : &lt;auth-mechanism&gt;
 credentials       : &lt;filename&gt;
 check-certificate : &lt;true-or-false&gt;
}
</pre></div>
</div>
<dl class="simple">
<dt>server</dt><dd><p>It is the SMTP server used to relay messages. If missing, it is assumed to be localhost.</p>
</dd>
<dt>encryption</dt><dd><p>The encryption mechanism. It can be: “none” (port 25, no encryption), “ssl” (port 465,
encryption required), “starttls” (port 25, encryption required), or “submission” (port 587,
encryption required). Please note that encryption is unrelated to authentication: you can
have an SSL-encrypted session on port 465 also with a server that does not require
authentication.</p>
</dd>
<dt>credentials</dt><dd><p>If authentication is required, you can specify here the pathname of a properties file, which
should contain at least the properties “host”, “user”, and “password”. The value of the “host”
property must match the smtp server name. The “user” property is the name used during
authentication; it can be “name”, or “<a class="reference external" href="mailto:name&#37;&#52;&#48;somehost">name<span>&#64;</span>somehost</a>”, depending on the providers.</p>
</dd>
<dt>check-certificate</dt><dd><p>When connecting using encryption, the validity of the SSL certificates is usually verified,
and the connection denied if verification fails. However, in case of self signed or test
certificates, it may be necessary to skip the certificate validation. The field
check-certificate is by default true, but you can explicitly set it to “false” in order to
bypass SSL certificate verification.</p>
</dd>
</dl>
</section>
<section id="flowdock">
<h2>Flowdock<a class="headerlink" href="#flowdock" title="Permalink to this heading">¶</a></h2>
<p>For Flowdock notifications, the “send” clause is:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{
 token     : &lt;api-token&gt;
 detail    : &lt;summary-or-short-or-long&gt;
 sender    : &lt;sender-name&gt;
 tags      : &lt;optional-tags&gt;
}
</pre></div>
</div>
<dl class="simple">
<dt>token</dt><dd><p>This is the Flowdock API token for the desired flow (it can be obtained from the
Flowdock interface, clicking on the settings gear)</p>
</dd>
<dt>detail</dt><dd><p>Optional, it can be one of “summary”, “short” (default), or “long”. It selects
the detail level of the notification text, with summary being a one-line message,
and long being a full report of all subprojects. For instance, in order to reduce
visual clutter, different notifications can be used together with different detail
levels: “when: bad, detail: long” and “when: good, detail: summary”.</p>
</dd>
<dt>sender</dt><dd><p>The name that Flowdock will display within the flow as the message sender. It need
not match any existing user in the system.</p>
</dd>
<dt>tags</dt><dd><p>An optional list of tags, which will be used by Flowdock to categorize the message.</p>
</dd>
</dl>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h2>
<p>Using the extended JSON syntax supported by the Typesafe config library, and the list
of defaults, the notifications can be expressed in a compact manner. For example, consider
the following example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>build.projects:[{...}]
options.notifications.send:[{
    projects: aabb
    send.to: &quot;user1@typesafe.com&quot;
   },{
    projects: [ccdd,eeff]
    send.to: &quot;user2@typesafe.com&quot;
   },{
    projects: &quot;.&quot;
    send.to: &quot;user3@typesafe.com&quot;
    when: [good, task-failed]
   },{
    projects: &quot;.&quot;
    kind: console
    when: always
}]
options.notifications.default.send:{
 from: &quot;your dbuild &lt;dbuild@server.com&gt;&quot;
 smtp:{
  server: &quot;smtp.server.com&quot;
  encryption:  &quot;ssl&quot;
  credentials: &quot;/home/user/.credentials-server&quot;
}}
</pre></div>
</div>
<p>The meaning is fairly obvious: a report about project aabb
is sent by email to user1 each time the build fails or succeeds for the first time (the default
is [“bad”,”success”]). The same applies for projects ccdd and eeff and user2. A report is sent to user3
with a report for the entire dbuild run in certain cases, and a short report is always printed
to the console. All of the email notifications, by default, will use the settings specified in
the default section, unless overridden.</p>
<p>This example uses a number of shortcuts. To begin with, the dot-notation is used to simplify
the structure of the configuration file: <code class="docutils literal notranslate"><span class="pre">build.projects</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">build:{projects:{</span></code>.
The double quotes have been omitted from most strings and labels, as well as commas. Then,
single strings have been used where a list was expected. Also, in the default list, we wrote
<code class="docutils literal notranslate"><span class="pre">options.notifications.default.wrote</span></code>. That is equivalent to having a single notification, used
in place of a list for the defaults, in which the default kind is “email” and in which
we specify the email default arguments for all the other email notifications. The defaults
section is therefore equivalent to the somewhat more verbose:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;options&quot;</span><span class="o">:</span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="s2">&quot;notifications&quot;</span><span class="o">:</span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="s2">&quot;default&quot;</span><span class="o">:</span><span class="p">[{</span><span class="w"></span>
<span class="w">       </span><span class="s2">&quot;kind&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;email&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">       </span><span class="s2">&quot;send&quot;</span><span class="w"> </span><span class="o">:</span><span class="p">{</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;from&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;your dbuild &lt;dbuild@server.com&gt;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">         </span><span class="s2">&quot;smtp&quot;</span><span class="o">:</span><span class="p">{</span><span class="w"></span>
<span class="w">           </span><span class="s2">&quot;server&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;smtp.server.com&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="s2">&quot;auth&quot;</span><span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;ssl&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="s2">&quot;credentials&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;/home/user/.credentials-server&quot;</span><span class="w"></span>
<span class="w">         </span><span class="p">}</span><span class="w"></span>
<span class="w">       </span><span class="p">}</span><span class="w"></span>
<span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}]</span><span class="w"></span>
<span class="w">    </span><span class="s2">&quot;send&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">...</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="templates">
<h2>Templates<a class="headerlink" href="#templates" title="Permalink to this heading">¶</a></h2>
<p>In order to customize the way in which reports are generated, it is
possible to create custom report templates, which are then used by
specifying their name in the notifications.
It is also possible to redefine the standard
templates “console” and “email”, which will then be used for all of
the corresponding reports.</p>
<p>A template is defined as:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>options.notifications.templates: [{
  id      : &lt;template-name&gt;
  summary : &lt;summary-string&gt;
  short   : &lt;short-string&gt;
  long    : &lt;long-string&gt;
},...]
</pre></div>
</div>
<dl class="simple">
<dt>id</dt><dd><p>The id of the template; it is then referred to from the field “template”
of the notifications.</p>
</dd>
<dt>summary</dt><dd><p>A summary should be &lt;50 characters, with a short message informing of what went wrong.
It is a required field in the template, and should be suitable, for example,
for a short console report or as an email subject line.</p>
</dd>
<dt>short</dt><dd><p>A slightly longer short summary (&lt;110 characters), suitable for SMS, Tweets, etc.
It should be self-contained in terms of information. Defaults to the short summary.</p>
</dd>
<dt>long</dt><dd><p>A long body with a more complete description. Defaults to the short message. Do not
terminate any of the three descriptions with a <code class="docutils literal notranslate"><span class="pre">\n</span></code>. A newline will be added by the
notification system only if it is required in that specific case.</p>
</dd>
</dl>
<p>Once a notification is ready to send a message, and the project outcome is available, the
final message will be created by using the template, the outcome, the environment variables,
and some template variables prepared by dbuild.</p>
<p>The environment variables can be substituted into the template using <code class="docutils literal notranslate"><span class="pre">${VARIABLE}</span></code>.
All of the Jenkins variables are also available, and
can be used to build informative messages. The dbuild-specific
variables (properties) are the following (this list is subject to adjustments
and changes):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>${dbuild.template-vars.project-name}
${dbuild.template-vars.status}
${dbuild.template-vars.subprojects-report}
${dbuild.template-vars.project-description}
${dbuild.template-vars.padded-project-description}
${dbuild.template-vars.config-name}
</pre></div>
</div>
<dl class="simple">
<dt>${dbuild.template-vars.project-name}</dt><dd><p>The name of the project we are sending a report about, or “.” for the root build.</p>
</dd>
<dt>${dbuild.template-vars.status}</dt><dd><p>A short status string from the outcome. It can be, for instance:
<code class="docutils literal notranslate"><span class="pre">EXTRACTION</span> <span class="pre">FAILED</span> <span class="pre">(Exception:</span> <span class="pre">Couldn't</span> <span class="pre">resolve)</span></code>.</p>
</dd>
<dt>${dbuild.template-vars.subprojects-report}</dt><dd><p>A compact report of the name and status of all of the projects that are
our dependencies; useful to determine the cause a broken dependencies status.
The variant “subprojects-report-tabs” prepends each line with a tab
character (used in Flowdock notifications).</p>
</dd>
<dt>${dbuild.template-vars.project-description}</dt><dd><p>The name of the project, preformatted as eithed “project &lt;name&gt;”, or “dbuild” for the root.</p>
</dd>
<dt>${dbuild.template-vars.padded-project-description}</dt><dd><p>As above, but padded to the left with “-” characters to a predetermined length.</p>
</dd>
<dt>${dbuild.template-vars.config-name}</dt><dd><p>The name of the configuration file that was passed as a parameter to dbuild.</p>
</dd>
</dl>
<p>In addition, as mentioned, if dbuild runs under Jenkins its environment variables are also
available; for example <code class="docutils literal notranslate"><span class="pre">${BUILD_URL}</span></code>, <code class="docutils literal notranslate"><span class="pre">${JOB_NAME}</span></code>, and <code class="docutils literal notranslate"><span class="pre">${NODE_NAME}</span></code>.</p>
<p>For example, the long format of the standard “email” template is:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>This is a test report for ${dbuild.template-vars.project-description} in the dbuild configuration &quot;${dbuild.template-vars.config-name}&quot;
running under the Jenkins job &quot;${JOB_NAME}&quot; on ${NODE_NAME}.

${dbuild.template-vars.subprojects-report}
** The current status of ${dbuild.template-vars.project-description} is:
${dbuild.template-vars.status}


A more detailed report of this dbuild run is available at:
${BUILD_URL}console
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><em>Next:</em> <a class="reference internal" href="comparison.html"><span class="doc">Comparing artifacts</span></a>.</p>
</section>
</section>


          </div>
          <div class="span3"><p class="contents-title">Contents</p>
              <div id="scroller-anchor">
                <div id="scroller">
                  <div id="toc"><ul>
<li><a class="reference internal" href="#">Notifications</a><ul>
<li><a class="reference internal" href="#the-notifications-section">The <code class="docutils literal notranslate"><span class="pre">notifications</span></code> section</a></li>
<li><a class="reference internal" href="#id1">Notifications</a></li>
<li><a class="reference internal" href="#outcomes-and-when">Outcomes and “when”</a></li>
<li><a class="reference internal" href="#the-send-clause">The “send” clause</a></li>
<li><a class="reference internal" href="#flowdock">Flowdock</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#templates">Templates</a></li>
</ul>
</li>
</ul>
</div>
                </div>
              </div></div>
        </div>
      </div>
    </div>
  </div>  
  

  </body>
</html>